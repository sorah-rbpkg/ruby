Index: ruby2.1-2.1.5/dir.c
===================================================================
--- ruby2.1-2.1.5.orig/dir.c	2019-11-21 18:07:05.642708934 +0100
+++ ruby2.1-2.1.5/dir.c	2019-11-21 18:07:05.638708736 +0100
@@ -2097,7 +2097,7 @@
     else
 	flags = 0;
 
-    StringValue(pattern);
+    StringValueCStr(pattern);
     FilePathStringValue(path);
 
     if (flags & FNM_EXTGLOB) {
Index: ruby2.1-2.1.5/test/ruby/test_fnmatch.rb
===================================================================
--- ruby2.1-2.1.5.orig/test/ruby/test_fnmatch.rb	2019-11-21 18:07:05.642708934 +0100
+++ ruby2.1-2.1.5/test/ruby/test_fnmatch.rb	2019-11-21 18:07:05.638708736 +0100
@@ -129,4 +129,10 @@
     assert_file.fnmatch("[a-\u3042]*", "\u3042")
     assert_file.not_fnmatch("[a-\u3042]*", "\u3043")
   end
+
+  def test_nullchar
+    assert_raise(ArgumentError) {
+      File.fnmatch("a\0z", "a")
+    }
+  end
 end
