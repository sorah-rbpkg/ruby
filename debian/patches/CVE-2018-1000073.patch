Description: fix directory traversal (CVE-2018-1000073)
Bug-Debian: https://bugs.debian.org/895778
Origin: vendor, https://github.com/rubygems/rubygems/commit/1b931fc03b819b9a0214be3eaca844ef534175e2
Last-Update: 2018-08-27

--- ruby2.1-2.1.5.orig/lib/rubygems/package.rb
+++ ruby2.1-2.1.5/lib/rubygems/package.rb
@@ -394,7 +394,8 @@ EOM
     destination_dir = File.expand_path destination_dir
 
     destination = File.join destination_dir, filename
-    destination = File.expand_path destination
+    destination = File.expand_path destination if
+      File.respond_to? :realpath
 
     raise Gem::Package::PathError.new(destination, destination_dir) unless
       destination.start_with? destination_dir + '/'
