Index: ruby2.1-2.1.5/ext/openssl/ossl_x509name.c
===================================================================
--- ruby2.1-2.1.5.orig/ext/openssl/ossl_x509name.c	2014-11-13 14:36:50.000000000 +0100
+++ ruby2.1-2.1.5/ext/openssl/ossl_x509name.c	2018-10-27 14:11:40.967504736 +0200
@@ -321,7 +321,7 @@
 
     result = ossl_x509name_cmp0(self, other);
     if (result < 0) return INT2FIX(-1);
-    if (result > 1) return INT2FIX(1);
+    if (result > 0) return INT2FIX(1);
 
     return INT2FIX(0);
 }
Index: ruby2.1-2.1.5/test/openssl/test_x509name.rb
===================================================================
--- ruby2.1-2.1.5.orig/test/openssl/test_x509name.rb	2014-11-13 14:36:50.000000000 +0100
+++ ruby2.1-2.1.5/test/openssl/test_x509name.rb	2018-10-27 14:13:31.823501413 +0200
@@ -337,10 +337,16 @@
   end
 
   def test_spaceship
-    n1 = OpenSSL::X509::Name.parse 'CN=a'
-    n2 = OpenSSL::X509::Name.parse 'CN=b'
+    n1 = OpenSSL::X509::Name.new([["CN", "a"]])
+    n2 = OpenSSL::X509::Name.new([["CN", "a"]])
+    n3 = OpenSSL::X509::Name.new([["CN", "ab"]])
 
-    assert_equal(-1, n1 <=> n2)
+    assert_equal 0, n1 <=> n2
+    assert_equal -1, n1 <=> n3
+    assert_equal 0, n2 <=> n1
+    assert_equal -1, n2 <=> n3
+    assert_equal 1, n3 <=> n1
+    assert_equal 1, n3 <=> n2
   end
 
   def name_hash(name)
