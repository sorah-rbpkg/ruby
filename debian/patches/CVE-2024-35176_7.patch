From: Sutou Kouhei <kou@clear-code.com>
Date: Tue, 11 Jun 2024 09:52:35 +0900
Subject: Add support for strscan 0.7.0 installed with Ruby 2.6

Fix GH-142

Reported by Fernando Trigoso. Thanks!!!

Origin: backport, https://github.com/ruby/rexml/commit/31738ccfc3324f4b32769fa1695c78c06a88c277
---
 lib/rexml/source.rb | 20 ++++++++++++++++++++
 1 file changed, 20 insertions(+)

diff --git a/lib/rexml/source.rb b/lib/rexml/source.rb
index 7132147..6b19d39 100644
--- a/lib/rexml/source.rb
+++ b/lib/rexml/source.rb
@@ -1,8 +1,28 @@
 # coding: US-ASCII
 # frozen_string_literal: false
+
+require "strscan"
+
 require_relative 'encoding'
 
 module REXML
+  if StringScanner::Version < "1.0.0"
+    module StringScannerCheckScanString
+      refine StringScanner do
+        def check(pattern)
+          pattern = /#{Regexp.escape(pattern)}/ if pattern.is_a?(String)
+          super(pattern)
+        end
+
+        def scan(pattern)
+          pattern = /#{Regexp.escape(pattern)}/ if pattern.is_a?(String)
+          super(pattern)
+        end
+      end
+    end
+    using StringScannerCheckScanString
+  end
+
   # Generates Source-s.  USE THIS CLASS.
   class SourceFactory
     # Generates a Source object
